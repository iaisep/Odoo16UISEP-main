<odoo>
    <record id="view_search_approval_request" model="ir.ui.view">
        <field name="name">Approval Request search</field>
        <field name="model">multi.request</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <filter string="My Request" name="filter_my_request" domain="[('user_id', '=', uid)]"/>
                <filter string="To Review" name="filter_approvals_to_review"
                        domain="[('line_ids.user_id', '=', uid), ('request_status', '=', 'pending')]"/>
            </search>
        </field>
    </record>

    <record model="ir.ui.view" id="multi_approval_product_line_view_tree">
        <field name="name">Approval Product Line</field>
        <field name="model">multi.product.line</field>
        <field name="arch" type="xml">
            <tree editable="bottom">
                <field name="product_id"/>
                <field name="quantity"/>
                <field name="product_uom_id"/>
            </tree>
        </field>
    </record>

    <record model="ir.ui.view" id="view_from_approval_request">
        <field name="name">Approval Request</field>
        <field name="model">multi.request</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <field name="user_status" invisible="1"/>
                    <button name="action_confirm" string="Submit" type="object"
                            attrs="{'invisible':[('request_status','!=','new')]}" class="btn-primary"/>
                    <button name="action_approve" string="Approve" type="object"
                            attrs="{'invisible':[('request_status','!=','pending')]}" class="btn-primary"/>
                    <button name="action_refuse" string="Refuse" type="object"
                            attrs="{'invisible':[('request_status','!=','pending')]}"/>
                    <button name="action_draft" string="Back To Draft" type="object"
                            attrs="{'invisible':[('request_status','!=','cancel')]}"/>
                    <button name="action_cancel" string="Cancel" type="object"
                            attrs="{'invisible':[('request_status','in',['new','cancel'])]}"/>
                    <widget name="attach_document" string="Attach Document" action="message_post"
                            attrs="{'invisible': [('attachment_number', '&lt;', 1)]}"/>
                    <widget name="attach_document" string="Attach Receipt" action="message_post" highlight="1"
                            attrs="{'invisible': ['|',('attachment_number', '&gt;=', 1), ('id','=',False)]}"/>
                    <field name="request_status" widget="statusbar"/>
                </header>
                <sheet>
                    <div class="o_not_full oe_button_box">
                        <button name="action_get_attachment_view" class="oe_stat_button" icon="fa-book"
                                type="object" attrs="{'invisible': [('attachment_number', '=', 0)]}">
                            <field name="attachment_number" widget="statinfo" string="Documents"
                                    options="{'reload_on_button': true}"/>
                        </button>
                    </div>
                    <field name="document_opt" invisible="1"/>
                    <field name="partner_opt" invisible="1"/>
                    <field name="date_opt" invisible="1"/>
                    <field name="period_opt" invisible="1"/>
                    <field name="product_opt" invisible="1"/>
                    <field name="quantity_opt" invisible="1"/>
                    <field name="amount_opt" invisible="1"/>
                    <field name="payment_opt" invisible="1"/>
                    <field name="reference_opt" invisible="1"/>
                    <field name="location_opt" invisible="1"/>

                    <div class="oe_title">
                        <label for="name" string="Approval Request"/>
                        <h1>
                            <field name="name" placeholder="E.g: Expenses Paris business trip"
                                    attrs="{'readonly':[('request_status','!=','new')]}"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="user_id" attrs="{'readonly':[('request_status','!=','new')]}"/>
                            <field name="approval_type_id" attrs="{'readonly':[('request_status','!=','new')]}"/>
                            <field name="date_confirmed" readonly="1"/>
                            <label for="date" string="Date"
                                    attrs="{'invisible':[('date_opt','==','none')], 'readonly':[('request_status','!=','new')]}"/>
                            <div attrs="{'invisible':[('date_opt','==','none')], 'readonly':[('request_status','!=','new')]}">
                                <div>
                                    <field name="date" class="oe_inline"
                                            attrs="{'required': [('date_opt','==','required')], 'readonly':[('request_status','!=','new')]}"/>
                                </div>
                            </div>
                            <label for="date_start" string="Period"
                                    attrs="{'invisible':[('period_opt','==','none')], 'readonly':[('request_status','!=','new')]}"/>
                            <div attrs="{'invisible':[('period_opt','==','none')], 'readonly':[('request_status','!=','new')]}">
                                <div>
                                    <span>From:</span>
                                    <field name="date_start" class="oe_inline"
                                            attrs="{'required': [('period_opt','==','required')], 'readonly':[('request_status','!=','new')]}"/>
                                </div>
                                <div>
                                    <span>to:</span>
                                    <field name="date_end" class="oe_inline ml-4"
                                            attrs="{'required': [('period_opt','==','required')], 'readonly':[('request_status','!=','new')]}"/>
                                </div>
                            </div>
                            <field name="location"
                                    attrs="{'invisible':[('location_opt','==','none')], 'required': [('location_opt','==','required')], 'readonly':[('request_status','!=','new')]}"
                                    placeholder="e.g. Brussels"/>
                            <field name="partner_id"
                                    attrs="{'invisible':[('partner_opt','==','none')], 'required': [('partner_opt','==','required')], 'readonly':[('request_status','!=','new')]}"/>
                        </group>
                        <group name="request_details">
                            <field name="quantity"
                                    attrs="{'invisible':['|', ('quantity_opt', '=', 'none'), ('product_opt', '!=', 'none')],'required': [('quantity_opt','=','required'), ('product_opt', '=', 'none')], 'readonly':[('request_status','!=','new')]}"/>
                            <field name="amount"
                                    attrs="{'invisible':[('amount_opt','==','none')], 'required': [('amount_opt','==','required')], 'readonly':[('request_status','!=','new')]}"/>
                            <field name="reference"
                                    attrs="{'invisible':[('reference_opt','==','none')], 'required': [('reference_opt','==','required')], 'readonly':[('request_status','!=','new')]}"/>
                            <field name="source_document" invisible="1"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Products" name="products"
                                attrs="{'invisible': [('product_opt', '=', 'none')], 'readonly':[('request_status','!=','new')]}">
                            <field name="product_line_ids"
                                    context="{'tree_view_ref': 'openeducat_multi_approval.multi_approval_product_line_view_tree'}"
                                    attrs="{'readonly':[('request_status','!=','new')]}"/>
                        </page>
                        <page string="Description" name="reason">
                            <field name="reason"
                                    attrs="{'readonly':[('request_status','not in',('new', 'pending'))]}"/>
                        </page>
                        <page string="Approver(s)">
                            <field name="line_ids" attrs="{'readonly':[('request_status','!=','new')]}">
                                <tree editable="bottom" decoration-success="status=='approved'"
                                        decoration-warning="status=='pending'" decoration-danger="status=='refused'">
                                    <field name="user_id"/>
                                    <field name="require_opt"/>
                                    <field name="status"/>
                                    <field name="approve_tmpl_id"/>
                                    <field name="reject_tmpl_id"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="activity_ids"/>
                    <field name="message_ids" options="{'post_refresh': 'always'}"/>
                </div>
            </form>
        </field>
    </record>

    <record model="ir.ui.view" id="view_tree_approval_request">
        <field name="name">Approval Request</field>
        <field name="model">multi.request</field>
        <field name="arch" type="xml">
            <tree create="false" sample="1" decoration-info="request_status == 'new'">
                <field name="name"/>
                <field name="user_id" widget="many2one_avatar_user"/>
                <field name="approval_type_id"/>
                <field name="request_status" decoration-info="request_status == 'new'"
                        decoration-warning="request_status == 'pending'"
                        decoration-success="request_status == 'approved'"
                        decoration-danger="request_status == 'refused'" widget="badge"/>
            </tree>
        </field>
    </record>
</odoo>
